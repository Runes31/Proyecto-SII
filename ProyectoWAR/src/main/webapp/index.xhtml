<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
	<h:outputStylesheet library="css" name="main.css"/>
	<title>Proyecto-SII</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"/>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto"/>
</h:head>

<h:body>
	<div class="topnav">
		<a class="active" href="#">Home</a>
		<a href="/ProyectoWAR/importar.xhtml">Importar</a>
		<a href="#contact">Contact</a>
		<a href="#about">About</a>
	</div>
	<div class="container">
        <h:form id="form">
			<div class="w3-row-padding">
				<div class="w3-half">
					<h:outputLabel styleClass="form-label" for="name">Nombre: </h:outputLabel>
					<h:inputText id="name" styleClass="w3-input w3-border" value="#{indexBean.name}" onkeypress="enter(event)"/>
				</div>
				<div class="w3-half">
					<h:outputLabel styleClass="form-label" for="titulacion">Titulacion: </h:outputLabel>
					<h:inputText id="titulacion" styleClass="w3-input w3-border"  value="#{indexBean.titulacion}" onkeypress="enter(event)"/>
				</div>
			</div>
			<div class="w3-row-padding">
				<div class="w3-third">
					<h:outputLabel styleClass="form-label" for="curso">Curso: </h:outputLabel>
					<h:inputText id="curso" styleClass="w3-input w3-border"  value="#{indexBean.curso}" onkeypress="enter(event)"/>
				</div>
				<div class="w3-third">
					<h:outputLabel styleClass="form-label" for="grupo">Grupo: </h:outputLabel>
					<h:inputText id="grupo" styleClass="w3-input w3-border"  value="#{indexBean.grupo}" onkeypress="enter(event)"/>
				</div>
				<div class="w3-third" style="padding-top: 25px">
					<h:outputLabel for="nuevo" styleClass="form-label">Nuevo ingreso: </h:outputLabel>
					<h:selectBooleanCheckbox id="nuevo" styleClass="w3-check" value="#{indexBean.nuevo}" onkeypress="enter(event)"/>
				</div>
			</div>
			<br/>
			<div style="text-align: right">
				<h:commandButton id="asignar" value="Asignar grupos" style="float:left; min-width: 150px; margin-left: 20px; min-height: 40px"
								 styleClass="btn btn-pr" actionListener="#{indexBean.asignar}">
				</h:commandButton>

				<h:commandButton id="search" value="Buscar" style="min-width: 150px; margin-right: 20px; min-height: 40px"
								 styleClass="btn btn-pr" actionListener="#{indexBean.search}">
					<f:ajax execute="@form" render="matriculas"/>
				</h:commandButton>
			</div>
		</h:form>
		<hr/>
		<div style="max-height: 500px; overflow-y: auto">
			<h:dataTable id="matriculas" value="#{indexBean.matriculas}" var="m">
				<h:column>
					<f:facet name="header">Alumno</f:facet>
					#{m.expediente.alumno.nombre}
				</h:column>
				<h:column>
					<f:facet name="header">Dni</f:facet>
					#{m.expediente.alumno.dni}
				</h:column>
				<h:column>
					<f:facet name="header">Número expediente</f:facet>
					#{m.expediente.numExpediente}
				</h:column>
				<h:column>
					<f:facet name="header">Titulación</f:facet>
					#{m.expediente.titulacion.nombre}
				</h:column>
				<h:column>
					<f:facet name="header">Curso</f:facet>
					#{m.cursoAcademico}
				</h:column>
				<h:column>
					<f:facet name="header">Asignaturas</f:facet>
					#{indexBean.printAsignaturas(m.asignaturasMatriculas)}
				</h:column>
				<h:column>
					<f:facet name="header">Acciones</f:facet>
					<h:commandButton value="Editar Matricula" styleClass="btn-pr"/>
					<h:commandButton value="Editar Expediente" styleClass="btn-pr"
									 onclick="showExpModal()" action="#{indexBean.selectExp(m.expediente)}">
						<f:ajax execute="" render="exp-form"/>
					</h:commandButton>
					<h:commandButton value="Editar Alumno" styleClass="btn-pr"/>
					<h:commandButton value="Editar Preferencias" styleClass="btn-pr"/>
				</h:column>
			</h:dataTable>
		</div>
	</div>

	<!-- Modal para editar expedientes -->
	<div id="id01" class="w3-modal">
		<div class="w3-modal-content">
			<div class="w3-container">
      <span onclick="document.getElementById('id01').style.display='none'"
			class="w3-button w3-display-topright">&times;</span>
				<h:form id="exp-form">
					<div class="w3-row-padding">
						<h2>Editar expediente</h2>
					</div>
					<div class="w3-row-padding">
						<h:outputLabel styleClass="form-label" for="numExpediente">Número de expediente: </h:outputLabel>
						<h:inputText disabled="true" styleClass="w3-input w3-border" id="numExpediente" value="#{indexBean.selExp.numExpediente}"/>
					</div>
					<div class="w3-row-padding">
					<h:outputLabel styleClass="form-label" for="activo">Activo: </h:outputLabel>
					<h:selectBooleanCheckbox id="activo" styleClass="w3-check" value="#{indexBean.selExp.activo}"/>
					</div>
					<div class="w3-row-padding">
					<h:outputLabel styleClass="form-label" for="media">Nota media provisional: </h:outputLabel>
					<h:inputText id="media" styleClass="w3-input w3-border" value="#{indexBean.selExp.notaMediaProvisional}"/>
					</div>
					<div class="w3-row-padding">
					<h:outputLabel styleClass="form-label" for="credFB">Créditos FB: </h:outputLabel>
					<h:inputText id="credFB" styleClass="w3-input w3-border" value="#{indexBean.selExp.creditosFB}"/>
					</div>
					<div class="w3-row-padding">
					<h:outputLabel styleClass="form-label" for="credOB">Créditos OB: </h:outputLabel>
					<h:inputText id="credOB" styleClass="w3-input w3-border" value="#{indexBean.selExp.creditosOB}"/>
					</div>
					<div class="w3-row-padding">
					<h:outputLabel styleClass="form-label" for="credOP">Créditos OP: </h:outputLabel>
					<h:inputText id="credOP" styleClass="w3-input w3-border" value="#{indexBean.selExp.creditosOP}"/>
					</div>
					<div class="w3-row-padding">
					<h:outputLabel styleClass="form-label" for="credCF">Créditos CF: </h:outputLabel>
					<h:inputText id="credCF" styleClass="w3-input w3-border" value="#{indexBean.selExp.creditosCF}"/>
					</div>
					<div class="w3-row-padding">
					<h:outputLabel styleClass="form-label" for="credPE">Créditos PE: </h:outputLabel>
					<h:inputText id="credPE" styleClass="w3-input w3-border" value="#{indexBean.selExp.creditosPE}"/>
					</div>
					<div class="w3-row-padding">
					<h:outputLabel styleClass="form-label" for="credTF">Créditos TF: </h:outputLabel>
					<h:inputText id="credTF" styleClass="w3-input w3-border" value="#{indexBean.selExp.creditosTF}"/>
					</div>

					<div class="w3-row-padding" style="text-align: center">
					<h:commandButton id="sendExp" value="Guardar" style="min-width: 150px; margin: 20px; min-height: 40px" onclick="hideModals()"
									 styleClass="btn btn-pr" actionListener="#{indexBean.saveExp}">
						<f:ajax execute="@form" render="matriculas"/>
					</h:commandButton>
					</div>
				</h:form>
			</div>
		</div>
	</div>
</h:body>
<h:outputScript name="main.js" library="js"/>
</html>