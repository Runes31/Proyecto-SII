CREATE TABLE ALUMNO (ID INTEGER NOT NULL, CODIGOPOSTAL VARCHAR, DIRECCION VARCHAR NOT NULL, DNI VARCHAR NOT NULL UNIQUE, EMAILINSTITUCIONAL VARCHAR NOT NULL, EMAILPERSONAL VARCHAR, LOCALIDAD VARCHAR NOT NULL, MOVIL VARCHAR, NOMBRE VARCHAR NOT NULL, PROVINCIA VARCHAR NOT NULL, TELEFONO VARCHAR, PRIMARY KEY (ID))
CREATE TABLE ASIGNATURA (REFERENCIA VARCHAR NOT NULL, CARACTER VARCHAR, CODIGO VARCHAR NOT NULL, CREDITOS INTEGER NOT NULL, CUATRIMESTRE VARCHAR, CURSO INTEGER, DURACION INTEGER, IDIOMAS VARCHAR, NOMBRE VARCHAR NOT NULL, OFERTADA BOOLEAN NOT NULL, TITULACION_CODIGO VARCHAR NOT NULL, PRIMARY KEY (REFERENCIA, TITULACION_CODIGO))
CREATE TABLE CENTRO (ID INTEGER NOT NULL, DIRECCION VARCHAR NOT NULL, NOMBRE VARCHAR NOT NULL UNIQUE, TLFCONSEJERIA INTEGER, PRIMARY KEY (ID))
CREATE TABLE CLASE (HORAINI TIME NOT NULL, DIA DATE NOT NULL, HORAFIN TIME, REFERENCIA VARCHAR NOT NULL, TITULACION_CODIGO VARCHAR NOT NULL, GRUPO_ID INTEGER NOT NULL, CURSOACADEMICO VARCHAR NOT NULL, PRIMARY KEY (HORAINI, DIA, REFERENCIA, TITULACION_CODIGO, GRUPO_ID, CURSOACADEMICO))
CREATE TABLE ENCUESTA (FECHAENVIO TIMESTAMP NOT NULL, EXPEDIENTE_NUMEXPEDIENTE INTEGER NOT NULL, PRIMARY KEY (FECHAENVIO, EXPEDIENTE_NUMEXPEDIENTE))
CREATE TABLE EXPEDIENTE (NUMEXPEDIENTE INTEGER NOT NULL, ACTIVO BOOLEAN, CREDITOSCF INTEGER NOT NULL, CREDITOSFB INTEGER NOT NULL, CREDITOSOB INTEGER NOT NULL, CREDITOSOP INTEGER NOT NULL, CREDITOSPE INTEGER NOT NULL, CREDITOSSUPERADOS INTEGER NOT NULL, CREDITOSTF INTEGER NOT NULL, NOTAMEDIAPROVISIONAL DOUBLE, ALUMNO_ID INTEGER NOT NULL, TITULACION_CODIGO VARCHAR NOT NULL, PRIMARY KEY (NUMEXPEDIENTE))
CREATE TABLE GRUPO (ID INTEGER NOT NULL, ASIGNAR BOOLEAN, CURSO VARCHAR NOT NULL UNIQUE, INGLES BOOLEAN NOT NULL, LETRA VARCHAR NOT NULL UNIQUE, PLAZAS INTEGER, TURNO VARCHAR NOT NULL, VISIBLE BOOLEAN, GRUPO_ID INTEGER, TITULACION_CODIGO VARCHAR, PRIMARY KEY (ID))
CREATE TABLE GRUPOSPORASIGNATURA (CURSOACADEMICO VARCHAR NOT NULL, OFERTA BOOLEAN, REFERENCIA VARCHAR NOT NULL, TITULACION_CODIGO VARCHAR NOT NULL, GRUPO_ID INTEGER NOT NULL, PRIMARY KEY (CURSOACADEMICO, REFERENCIA, TITULACION_CODIGO, GRUPO_ID))
CREATE TABLE MATRICULA (CURSOACADEMICO VARCHAR NOT NULL, ESTADO VARCHAR NOT NULL, FECHAMATRICULA TIMESTAMP NOT NULL, LISTADOASIGNATURAS VARCHAR, NUEVOINGRESO BOOLEAN, NUMARCHIVO INTEGER NOT NULL, TURNOPREFERENTE VARCHAR, EXPEDIENTE_NUMEXPEDIENTE INTEGER NOT NULL, PRIMARY KEY (CURSOACADEMICO, EXPEDIENTE_NUMEXPEDIENTE))
CREATE TABLE OPTATIVA (REFERENCIA VARCHAR NOT NULL, CARACTER VARCHAR, CODIGO VARCHAR NOT NULL, CREDITOS INTEGER NOT NULL, CUATRIMESTRE VARCHAR, CURSO INTEGER, DURACION INTEGER, IDIOMAS VARCHAR, MENCION VARCHAR, NOMBRE VARCHAR NOT NULL, OFERTADA BOOLEAN NOT NULL, PLAZAS INTEGER NOT NULL, TITULACION_CODIGO VARCHAR NOT NULL, PRIMARY KEY (REFERENCIA, TITULACION_CODIGO))
CREATE TABLE TITULACION (CODIGO VARCHAR NOT NULL, CREDITOS INTEGER NOT NULL, NOMBRE VARCHAR NOT NULL, PRIMARY KEY (CODIGO))
CREATE TABLE ASIGNATURASMATRICULA (REFERENCIA VARCHAR NOT NULL, TITULACION_CODIGO VARCHAR NOT NULL, GRUPO_ID INTEGER, EXPEDIENTE_NUMEXPEDIENTE INTEGER NOT NULL, CURSOACADEMICO VARCHAR NOT NULL, PRIMARY KEY (REFERENCIA, TITULACION_CODIGO, EXPEDIENTE_NUMEXPEDIENTE, CURSOACADEMICO))
CREATE TABLE centro_titulacion (centro_id INTEGER NOT NULL, titulacion_id VARCHAR NOT NULL, PRIMARY KEY (centro_id, titulacion_id))
CREATE TABLE ENCUESTA_GRUPOSPORASIGNATURA (FECHAENVIO TIMESTAMP NOT NULL, EXPEDIENTE_NUMEXPEDIENTE INTEGER NOT NULL, CURSOACADEMICO VARCHAR NOT NULL, REFERENCIA VARCHAR NOT NULL, TITULACION_CODIGO VARCHAR NOT NULL, GRUPO_ID INTEGER NOT NULL, PRIMARY KEY (FECHAENVIO, EXPEDIENTE_NUMEXPEDIENTE, CURSOACADEMICO, REFERENCIA, TITULACION_CODIGO, GRUPO_ID))
ALTER TABLE ASIGNATURA ADD CONSTRAINT FK_ASIGNATURA_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE CLASE ADD CONSTRAINT FK_CLASE_CURSOACADEMICO FOREIGN KEY (CURSOACADEMICO, REFERENCIA, TITULACION_CODIGO, GRUPO_ID) REFERENCES GRUPOSPORASIGNATURA (CURSOACADEMICO, REFERENCIA, TITULACION_CODIGO, GRUPO_ID)
ALTER TABLE ENCUESTA ADD CONSTRAINT FK_ENCUESTA_EXPEDIENTE_NUMEXPEDIENTE FOREIGN KEY (EXPEDIENTE_NUMEXPEDIENTE) REFERENCES EXPEDIENTE (NUMEXPEDIENTE)
ALTER TABLE EXPEDIENTE ADD CONSTRAINT FK_EXPEDIENTE_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE EXPEDIENTE ADD CONSTRAINT FK_EXPEDIENTE_ALUMNO_ID FOREIGN KEY (ALUMNO_ID) REFERENCES ALUMNO (ID)
ALTER TABLE GRUPO ADD CONSTRAINT FK_GRUPO_GRUPO_ID FOREIGN KEY (GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE GRUPO ADD CONSTRAINT FK_GRUPO_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE GRUPOSPORASIGNATURA ADD CONSTRAINT FK_GRUPOSPORASIGNATURA_GRUPO_ID FOREIGN KEY (GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE MATRICULA ADD CONSTRAINT FK_MATRICULA_EXPEDIENTE_NUMEXPEDIENTE FOREIGN KEY (EXPEDIENTE_NUMEXPEDIENTE) REFERENCES EXPEDIENTE (NUMEXPEDIENTE)
ALTER TABLE OPTATIVA ADD CONSTRAINT FK_OPTATIVA_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE ASIGNATURASMATRICULA ADD CONSTRAINT FK_ASIGNATURASMATRICULA_CURSOACADEMICO FOREIGN KEY (CURSOACADEMICO, EXPEDIENTE_NUMEXPEDIENTE) REFERENCES MATRICULA (CURSOACADEMICO, EXPEDIENTE_NUMEXPEDIENTE)
ALTER TABLE ASIGNATURASMATRICULA ADD CONSTRAINT FK_ASIGNATURASMATRICULA_GRUPO_ID FOREIGN KEY (GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE centro_titulacion ADD CONSTRAINT FK_centro_titulacion_titulacion_id FOREIGN KEY (titulacion_id) REFERENCES TITULACION (CODIGO)
ALTER TABLE centro_titulacion ADD CONSTRAINT FK_centro_titulacion_centro_id FOREIGN KEY (centro_id) REFERENCES CENTRO (ID)
ALTER TABLE ENCUESTA_GRUPOSPORASIGNATURA ADD CONSTRAINT FK_ENCUESTA_GRUPOSPORASIGNATURA_CURSOACADEMICO FOREIGN KEY (CURSOACADEMICO, REFERENCIA, TITULACION_CODIGO, GRUPO_ID) REFERENCES GRUPOSPORASIGNATURA (CURSOACADEMICO, REFERENCIA, TITULACION_CODIGO, GRUPO_ID)
ALTER TABLE ENCUESTA_GRUPOSPORASIGNATURA ADD CONSTRAINT FK_ENCUESTA_GRUPOSPORASIGNATURA_FECHAENVIO FOREIGN KEY (FECHAENVIO, EXPEDIENTE_NUMEXPEDIENTE) REFERENCES ENCUESTA (FECHAENVIO, EXPEDIENTE_NUMEXPEDIENTE)
CREATE TABLE SEQUENCE (SEQ_NAME VARCHAR(50) NOT NULL, SEQ_COUNT NUMERIC(38), PRIMARY KEY (SEQ_NAME))
INSERT INTO SEQUENCE(SEQ_NAME, SEQ_COUNT) values ('SEQ_GEN', 0)
