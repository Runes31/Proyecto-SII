CREATE TABLE ALUMNO (ID INTEGER NOT NULL, CODIGOPOSTAL VARCHAR(255), DIRECCION VARCHAR(255) NOT NULL, DNI VARCHAR(255) NOT NULL UNIQUE, EMAILINSTITUCIONAL VARCHAR(255) NOT NULL, EMAILPERSONAL VARCHAR(255), LOCALIDAD VARCHAR(255) NOT NULL, MOVIL VARCHAR(255), NOMBRE VARCHAR(255) NOT NULL, PROVINCIA VARCHAR(255) NOT NULL, TELEFONO VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE ASIGNATURA (REFERENCIA VARCHAR(255) NOT NULL, disc VARCHAR(31), CARACTER VARCHAR(255), CODIGO VARCHAR(255) NOT NULL, CREDITOS INTEGER NOT NULL, CUATRIMESTRE VARCHAR(255), CURSO INTEGER, DURACION INTEGER, IDIOMAS VARCHAR(255), NOMBRE VARCHAR(255) NOT NULL, OFERTADA TINYINT(1) default 0 NOT NULL, TITULACION_CODIGO VARCHAR(255) NOT NULL, MENCION VARCHAR(255), PLAZAS INTEGER NOT NULL, PRIMARY KEY (REFERENCIA))
CREATE TABLE CENTRO (ID INTEGER NOT NULL, DIRECCION VARCHAR(255) NOT NULL, NOMBRE VARCHAR(255) NOT NULL UNIQUE, TLFCONSEJERIA INTEGER, PRIMARY KEY (ID))
CREATE TABLE CLASE (HORAINI TIME NOT NULL, DIA DATE NOT NULL, HORAFIN TIME, GRUPO_ID INTEGER NOT NULL, gruposPorAsignaturas_asignatura_fk VARCHAR(255) NOT NULL, gruposPorAsignaturas_curso_fk VARCHAR(255) NOT NULL, gruposPorAsignaturas_grupo_fk INTEGER NOT NULL, PRIMARY KEY (HORAINI, DIA, GRUPO_ID))
CREATE TABLE ENCUESTA (FECHAENVIO DATETIME NOT NULL, EXPEDIENTE_NUMEXPEDIENTE INTEGER NOT NULL, PRIMARY KEY (FECHAENVIO, EXPEDIENTE_NUMEXPEDIENTE))
CREATE TABLE EXPEDIENTE (NUMEXPEDIENTE INTEGER NOT NULL, ACTIVO TINYINT(1) default 0, CREDITOSCF INTEGER NOT NULL, CREDITOSFB INTEGER NOT NULL, CREDITOSOB INTEGER NOT NULL, CREDITOSOP INTEGER NOT NULL, CREDITOSPE INTEGER NOT NULL, CREDITOSSUPERADOS INTEGER NOT NULL, CREDITOSTF INTEGER NOT NULL, NOTAMEDIAPROVISIONAL DOUBLE, ALUMNO_ID INTEGER NOT NULL, TITULACION_CODIGO VARCHAR(255) NOT NULL, PRIMARY KEY (NUMEXPEDIENTE))
CREATE TABLE GRUPO (ID INTEGER NOT NULL, ASIGNAR TINYINT(1) default 0, CURSO VARCHAR(255) NOT NULL UNIQUE, INGLES TINYINT(1) default 0 NOT NULL, LETRA VARCHAR(255) NOT NULL UNIQUE, PLAZAS INTEGER, TURNO VARCHAR(255) NOT NULL, VISIBLE TINYINT(1) default 0, GRUPO_ID INTEGER, TITULACION_CODIGO VARCHAR(255), PRIMARY KEY (ID))
CREATE TABLE GRUPOSPORASIGNATURA (CURSOACADEMICO VARCHAR(255) NOT NULL, OFERTA TINYINT(1) default 0, ASIGNATURA_REFERENCIA VARCHAR(255) NOT NULL, GRUPO_ID INTEGER NOT NULL, PRIMARY KEY (CURSOACADEMICO, ASIGNATURA_REFERENCIA, GRUPO_ID))
CREATE TABLE MATRICULA (CURSOACADEMICO VARCHAR(255) NOT NULL, ESTADO VARCHAR(255) NOT NULL, FECHAMATRICULA DATETIME NOT NULL, LISTADOASIGNATURAS VARCHAR(255), NUEVOINGRESO TINYINT(1) default 0, NUMARCHIVO INTEGER NOT NULL, TURNOPREFERENTE VARCHAR(255), EXPEDIENTE_NUMEXPEDIENTE INTEGER NOT NULL, PRIMARY KEY (CURSOACADEMICO, EXPEDIENTE_NUMEXPEDIENTE))
CREATE TABLE TITULACION (CODIGO VARCHAR(255) NOT NULL, CREDITOS INTEGER NOT NULL, NOMBRE VARCHAR(255) NOT NULL, PRIMARY KEY (CODIGO))
CREATE TABLE ASIGNATURASMATRICULA (ASIGNATURA_REFERENCIA VARCHAR(255) NOT NULL, GRUPO_ID INTEGER, EXPEDIENTE_NUMEXPEDIENTE INTEGER NOT NULL, CURSOACADEMICO VARCHAR(255) NOT NULL, PRIMARY KEY (ASIGNATURA_REFERENCIA, EXPEDIENTE_NUMEXPEDIENTE, CURSOACADEMICO))
CREATE TABLE centro_titulacion (centro_id INTEGER NOT NULL, titulacion_id VARCHAR(255) NOT NULL, PRIMARY KEY (centro_id, titulacion_id))
CREATE TABLE ENCUESTA_GRUPOSPORASIGNATURA (FECHAENVIO DATETIME NOT NULL, EXPEDIENTE_NUMEXPEDIENTE INTEGER NOT NULL, CURSOACADEMICO VARCHAR(255) NOT NULL, ASIGNATURA_REFERENCIA VARCHAR(255) NOT NULL, GRUPO_ID INTEGER NOT NULL, PRIMARY KEY (FECHAENVIO, EXPEDIENTE_NUMEXPEDIENTE, CURSOACADEMICO, ASIGNATURA_REFERENCIA, GRUPO_ID))
ALTER TABLE ASIGNATURA ADD CONSTRAINT FK_ASIGNATURA_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE CLASE ADD CONSTRAINT FK_CLASE_GRUPO_ID FOREIGN KEY (GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE CLASE ADD CONSTRAINT FK_CLASE_gruposPorAsignaturas_curso_fk FOREIGN KEY (gruposPorAsignaturas_curso_fk, gruposPorAsignaturas_asignatura_fk, gruposPorAsignaturas_grupo_fk) REFERENCES GRUPOSPORASIGNATURA (CURSOACADEMICO, ASIGNATURA_REFERENCIA, GRUPO_ID)
ALTER TABLE ENCUESTA ADD CONSTRAINT FK_ENCUESTA_EXPEDIENTE_NUMEXPEDIENTE FOREIGN KEY (EXPEDIENTE_NUMEXPEDIENTE) REFERENCES EXPEDIENTE (NUMEXPEDIENTE)
ALTER TABLE EXPEDIENTE ADD CONSTRAINT FK_EXPEDIENTE_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE EXPEDIENTE ADD CONSTRAINT FK_EXPEDIENTE_ALUMNO_ID FOREIGN KEY (ALUMNO_ID) REFERENCES ALUMNO (ID)
ALTER TABLE GRUPO ADD CONSTRAINT FK_GRUPO_GRUPO_ID FOREIGN KEY (GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE GRUPO ADD CONSTRAINT FK_GRUPO_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE GRUPOSPORASIGNATURA ADD CONSTRAINT FK_GRUPOSPORASIGNATURA_GRUPO_ID FOREIGN KEY (GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE GRUPOSPORASIGNATURA ADD CONSTRAINT FK_GRUPOSPORASIGNATURA_ASIGNATURA_REFERENCIA FOREIGN KEY (ASIGNATURA_REFERENCIA) REFERENCES ASIGNATURA (REFERENCIA)
ALTER TABLE MATRICULA ADD CONSTRAINT FK_MATRICULA_EXPEDIENTE_NUMEXPEDIENTE FOREIGN KEY (EXPEDIENTE_NUMEXPEDIENTE) REFERENCES EXPEDIENTE (NUMEXPEDIENTE)
ALTER TABLE ASIGNATURASMATRICULA ADD CONSTRAINT FK_ASIGNATURASMATRICULA_ASIGNATURA_REFERENCIA FOREIGN KEY (ASIGNATURA_REFERENCIA) REFERENCES ASIGNATURA (REFERENCIA)
ALTER TABLE ASIGNATURASMATRICULA ADD CONSTRAINT FK_ASIGNATURASMATRICULA_CURSOACADEMICO FOREIGN KEY (CURSOACADEMICO, EXPEDIENTE_NUMEXPEDIENTE) REFERENCES MATRICULA (CURSOACADEMICO, EXPEDIENTE_NUMEXPEDIENTE)
ALTER TABLE ASIGNATURASMATRICULA ADD CONSTRAINT FK_ASIGNATURASMATRICULA_GRUPO_ID FOREIGN KEY (GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE centro_titulacion ADD CONSTRAINT FK_centro_titulacion_titulacion_id FOREIGN KEY (titulacion_id) REFERENCES TITULACION (CODIGO)
ALTER TABLE centro_titulacion ADD CONSTRAINT FK_centro_titulacion_centro_id FOREIGN KEY (centro_id) REFERENCES CENTRO (ID)
ALTER TABLE ENCUESTA_GRUPOSPORASIGNATURA ADD CONSTRAINT FK_ENCUESTA_GRUPOSPORASIGNATURA_CURSOACADEMICO FOREIGN KEY (CURSOACADEMICO, ASIGNATURA_REFERENCIA, GRUPO_ID) REFERENCES GRUPOSPORASIGNATURA (CURSOACADEMICO, ASIGNATURA_REFERENCIA, GRUPO_ID)
ALTER TABLE ENCUESTA_GRUPOSPORASIGNATURA ADD CONSTRAINT FK_ENCUESTA_GRUPOSPORASIGNATURA_FECHAENVIO FOREIGN KEY (FECHAENVIO, EXPEDIENTE_NUMEXPEDIENTE) REFERENCES ENCUESTA (FECHAENVIO, EXPEDIENTE_NUMEXPEDIENTE)
CREATE TABLE SEQUENCE (SEQ_NAME VARCHAR(50) NOT NULL, SEQ_COUNT DECIMAL(38), PRIMARY KEY (SEQ_NAME))
INSERT INTO SEQUENCE(SEQ_NAME, SEQ_COUNT) values ('SEQ_GEN', 0)
